import os, asyncio
from telethon import TelegramClient, events
from telethon.sessions import StringSession

# ุชูุธูุงุช ุงุฒ Secrets ฺฏุชโูุงุจ
API_ID = int(os.getenv('API_ID', 0))
API_HASH = os.getenv('API_HASH', '')
STRING_SESSION = os.getenv('STRING_SESSION', '')

# ูุตู ุดุฏู ุจุง ุงฺฉุงูุช ุดุฎุต ููุฑุฏุงุฏ
client = TelegramClient(StringSession(STRING_SESSION), API_ID, API_HASH)

print("๐ Userbot for 'A Beautiful Mind' is starting...")

@client.on(events.ChatAction)
async def group_welcome_manager(event):
    try:
        user = await event.get_user()
        # ูุงุฏุฏู ฺฏุฑูุชู ุฎูุฏ ููุฑุฏุงุฏ ู ุจูู ุฑุจุงุชโูุง
        if not user or user.is_self or user.bot:
            return

        # --- ูุชู ุฎูุดโุขูุฏฺฏู ููุฑุฏุงุฏ ---
        welcome_text = f"""ุณูุงู {user.first_name} ุนุฒุฒ

ู ุชูุถุญ ฺฉูุชุงู ุงูู ฺฉุงุฑ: ุงู ูพุงู ุจูโุตูุฑุช ุงุชููุงุชฺฉ ุชูุณุท ุจุงุช ุชูฺฏุฑุงู ู ฺฉุฏูุง ูพุงุชูู ุงุฑุณุงู ุดุฏูุ ูพุณ ุงฺฏู ุฌูุงุจ ูุฏุงุฏู ุจุฏูู ุง ุขููุงูู ุง ุฎูุงุจู ุง ุจู ุชูฺฏุฑุงู ุฏุณุชุฑุณ ูุฏุงุฑู.
ุฎุจโฆ

ุจู ฺฏุฑูู ุดุฎุต ููุ ููุฑุฏุงุฏุ ุฎูุด ุงููุฏ.

ุงู ฺฉู ุงูุงู ุงูุฌุง ุนู ุงุญุชูุงูุงู ูโุณุฑ ุณููู ู ุนูุงููโ ูุดุชุฑฺฉ ุฏุงุฑูุ
ุงุฒ ููู ู ููุณู ฺฏุฑูุชู ุชุง ุญุงูโูููุง ุฑูุฒูุฑู ู ฺุฒุง ฺฉู ุชู ุงู ุฏูุง ูุฌุงุฒ ุจุง ูู ุดุฑฺฉ ูโุดู.
ุงูุฏูุงุฑู ุชู ฺฏุฑูู ูุญุธุงุช ุฎูุจ ุฏุงุดุชู ุจุงุด ู ูุทุงูุจ ุจู ฺฉุงุฑุช ุจุงุฏ.

ููููู ฺฉู ูุณุช.
ุงฺฏู ุฎูุฏุช ูู ฺฉุงูุงู ุฏุงุฑุ ููฺฉุดู ูููโุฌุง ุจูุฑุณุชุ
ุจู ูุญุถ ุงู ฺฉู ุฎูุฏู (ูู ุฑุจุงุช) ุขููุงู ุจุดูุ ุญุชูุงู ุณุฑ ูโุฒูู.

ุงฺฏู ุฏูุณุช ุฏุงุดุชุ ุฎูุฏุช ุฑู ูู ูุนุฑู ฺฉู.
โจ ุจู ฺฏุฑูู 'A Beautiful Mind' ุฎูุด ุงููุฏ"""

        # --- ูุชู ุฌุฏุฏ ุฎุฏุงุญุงูุธ ููุฑุฏุงุฏ ---
        goodbye_text = f"""ุฏุฏู ุฑูุชุ ฺฏูุชู ุจฺฏู: ฺุฑุงุ ๐
ุดูุฎ ุดูุฎโฆ
ุจูโูุฑุญุงู ููููู ุงุฒ ููุฑุงูโุชุ ุณูุงูุช ุจุงุด."""

        # ุงุฌุฑุง ุฏุฑ ุตูุฑุช ูุฑูุฏ ุจู ฺฏุฑูู
        if event.user_joined or event.user_added:
            await event.reply(welcome_text)
            print(f"โ ูพุงู ุฎูุดโุขูุฏฺฏู ุจุฑุง {user.first_name} ุงุฑุณุงู ุดุฏ.")

        # ุงุฌุฑุง ุฏุฑ ุตูุฑุช ุฎุฑูุฌ ุงุฒ ฺฏุฑูู
        elif event.user_left:
            await client.send_message(event.chat_id, goodbye_text)
            print(f"๐ ูพุงู ุฎุฏุงุญุงูุธ ุฌุฏุฏ ุจุฑุง {user.first_name} ุงุฑุณุงู ุดุฏ.")

    except Exception as e:
        print(f"โ ุฎุทุง ุฏุฑ ุงุฌุฑุง: {e}")

async def run():
    await client.start()
    print("โ ุงฺฉุงูุช ููุฑุฏุงุฏ ูุชุตู ุดุฏ ู ุขูุงุฏู ุฎูุดโุขูุฏฺฏู ุฏุฑ ฺฏุฑูู ุงุณุช.")
    await client.run_until_disconnected()

if __name__ == '__main__':
    asyncio.run(run())
